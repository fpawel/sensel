# Установка контроля чувствительных элементов. 

Программное обеспечение (ПО) предназначено для настройки чувствительных элементов (ЧЭ) в лаборатории №74. 
ПО представляет собой приложение Win32 для персональных компьютеров (ПК) и рабочих станций. 

## Системные требования. 

* **Windows 7** или более поздняя версия 32-разрядной (x86) или 64-разрядной (x64) ОС семейства **Windows NT**. ПО не работает на ОС Windows XP.

* 32-разрядный (x86) или 64-разрядный (x64) процессор с тактовой частотой 1 ГГц или выше.

* 1 ГБ (для 32-разрядного процессора) или 2 ГБ (для 64-разрядного процессора) ОЗУ.

* 50 ГБ (для 32-разрядной системы) или 100 ГБ (для 64-разрядной системы) свободного места на жестком диске.

* Графическое устройство DirectX 9 с драйвером WDDM 1.0 или более поздней версии.

* Для просмотра и печати отчётов необходим установленный **Adobe Acrobat Reader**

* Локальное расположение ПО необходимо внести в список исключений используемого антивируса.

* Текущий пользователь ОС должен иметь права доступа на чтение и запись.

## Структура и расположение ПО 

* Последняя версия ПО находится в сетевом расположении **\\a\a\OGM-SOFT\sensel** Для использования ПО на локальном ПК необходимо скопировать этот сетевой каталог в произвольное локальное расположение, для которого 

* Исполняемый модуль ПО: **sensel.exe**  Все расположения и пути к локальным файлам здесь и далее указаны относительно каталога исполняемого модуля.

* После запуска исполняемого модуля ПО создаёт файл **sensel.sqlite** при его отсутствии, в котором сохраняются все результаты обмеров ЧЭ, выполняемых ПО. 

* Технологический процесс обмера и параметры исполнений ЧЭ, используемые в ПО, разработаны инженерами лаборатории №74 и записаны в файле **lua/sensel.lua** Данный файл представляет собой скрипт на языке Lua, вызываемый ПО в процессе обмера ЧЭ.

* Для переноса ПО на другой ПК или в другое расположение необходимо дополнительно скопировать следующие файлы с сохранением расположения относительно исполняемого модуля ПО: 
    * **sensel.sqlite** (в том случае, если он содержит данные, представляющие ценность)
    * **lua/sensel.lua**

* ПО формирует отчёты в формате *pdf*. Отчёты помещаются в каталог **pdf**. Перед созданием отчёта ПО удаляет всё содержимое данного каталога. Поэтому для сохранения файла отчёта необходимо сделать это в **Adobe Acrobat Reader**. 

## Работа с ПО

Перед тем, как запустить **sensel.exe** и приступить к обмеру ЧЭ, необходимо правильно указать параметры исполнений в файле **lua/sensel.lua**. В противном случае ПО либо выдаст сообщение об ошибке при запуске, либо будет работать не корректно.    

После запуска **sensel.exe** пользователь ПК может управлять работой ПО в главном окне программы. Основными элементами управления являются: 
* главное меню программы
* выпадающий список для выбора обмера  
* таблица результатов обмера 
* информационные сообщения статуса

![Главное окно программы](img/mainwindow.png "Примерный вид главного окна")

### Таблица результатов обмера

Таблица содержит измеренные напряжения ЧЭ (колонки "Обмер №...") и рассчитанные параметры ЧЭ согласно указанному исполнению ЧЭ. Красный кружок в колонке "Датчик" означает, что в процессе обмера ПО обнаружило обрыв данного ЧЭ.   

### Подготовка обмера

Перед выполнением обмера необходимо: 
* подготовить и подключить планку ЧЭ к стенду
* подключить стенд, вольтметр и газовый блок согласно паспорту на стенд
* указать СОМ порты оборудования в соответствующих выпадающих в нижней части главного окна   

Выбора пункта **Обмер** главного меню вызовет появление диалога для указания параметров ЧЭ: 

![Окно диалога новое измерение](img/new_measure_dialog.png "Окно диалога новое измерение")

Необходимо указать исполнение ЧЭ в соответствующих выпадающих списках, ввести значения концентрации поверочных газовых смесей (ПГС) с баллонов. При необходимости ввести текст комментария обмера. После нажатия кнопки **Ok** начнётся обмер. 

### Выполнение обмера